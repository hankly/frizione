(function(){if(window.google&&google.gears){return ;}var factory=null;if(typeof GearsFactory!="undefined"){factory=new GearsFactory();}else{try{factory=new ActiveXObject("Gears.Factory");if(factory.getBuildInfo().indexOf("ie_mobile")!=-1){factory.privateSetGlobalObject(this);}}catch(e){if((typeof navigator.mimeTypes!="undefined")&&navigator.mimeTypes["application/x-googlegears"]){factory=document.createElement("object");factory.style.display="none";factory.width=0;factory.height=0;factory.type="application/x-googlegears";document.documentElement.appendChild(factory);}}}if(!factory){return ;}if(!window.google){google={};}if(!google.gears){google.gears={factory:factory};}})();if(!this.JSON){JSON=function(){function f(n){return n<10?"0"+n:n;}Date.prototype.toJSON=function(key){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z";};var cx=new RegExp("[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]","g"),escapeable=new RegExp('[\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]',"g"),gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapeable.lastIndex=0;return escapeable.test(string)?'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==="string"){return c;}return"\\u"+("0000"+(+(a.charCodeAt(0))).toString(16)).slice(-4);})+'"':'"'+string+'"';}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key);}if(typeof rep==="function"){value=rep.call(holder,key,value);}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null";}gap+=indent;partial=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null";}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v;}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value,rep);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value,rep);if(v){partial.push(quote(k)+(gap?": ":":")+v);}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v;}}return{stringify:function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" ";}}else{if(typeof space==="string"){indent=space;}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify");}return str("",{"":value});},parse:function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}return reviver.call(holder,key,value);}cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+(+(a.charCodeAt(0))).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=new Function("return ("+text+");")();return typeof reviver==="function"?walk({"":j},""):j;}throw new SyntaxError("JSON.parse");}};}();}if(!this.clutch){clutch={};}if(!this.clutch.test){clutch.test={};}clutch.test.executeRequest=function(method,url,optionalParams,optionalBody,timeout,handler){var requestTimeout=timeout||5000;function createRequest(){try{return new XMLHttpRequest();}catch(e1){try{return new ActiveXObject("Msxml2.XMLHTTP");}catch(e2){try{return new ActiveXObject("Microsoft.XMLHTTP");}catch(e3){}}}return null;}var request=createRequest();var terminated=false;var requestTimerId=window.setTimeout(function(){terminated=true;handler(-1,"Timeout","");},requestTimeout);var param=null;var qmark="?";if(optionalParams){for(param in optionalParams){if(optionalParams.hasOwnProperty(param)){url+=qmark+param+"="+optionalParams[param];qmark="";}}}try{request.onreadystatechange=function(){if(terminated){return ;}try{if(request.readyState===4){var status,statusText,responseText;try{status=request.status;statusText=request.statusText;responseText=request.responseText;}catch(e1){}terminated=true;window.clearTimeout(requestTimerId);if(status===0){status=200;}handler(status,statusText,responseText);}}catch(e2){throw e2;}};request.open(method,url,true);if(optionalBody){request.setRequestHeader("Content-Length",optionalBody.length);}request.send(optionalBody||null);}catch(e){terminated=true;request=null;window.clearTimeout(requestTimerId);window.setTimeout(handler,0);}};if(!this.clutch){clutch={};}clutch.date={toClutchJSON:function(){function tens(n){return n<10?"0"+n:n;}function hundreds(n){return n<100?"0"+tens(n):n;}Date.prototype.toJSON=function(){return"\\/Date("+this.getUTCFullYear()+"-"+tens(this.getUTCMonth()+1)+"-"+tens(this.getUTCDate())+"T"+tens(this.getUTCHours())+":"+tens(this.getUTCMinutes())+":"+tens(this.getUTCSeconds())+"."+hundreds(this.getUTCMilliseconds())+"Z)\\/";};}};clutch.storeTests=function(scriptUrl,fixtureUrl,viewUrl){var date=new Date().toUTCString();var worker=null;var workerId=null;var element=document.getElementById("test-results");function handleRequest(status,statusText,responseText){if(status>=200&&status<=299){element.innerHTML="Unit tests <a href = '"+viewUrl+"'>completed</a> and stored.";}else{element.innerHTML="Couldn't store the unit test data. Status: "+status+" "+statusText;}}function sendStatusMessage(){worker.sendMessage({command:"clutch.test.status"},workerId);}function checkTests(results){var status=results.status;if(status.complete&&results.summary){element.innerHTML="Unit tests completed...";clutch.date.toClutchJSON();results.summary.summary.date=date;clutch.test.executeRequest("POST",fixtureUrl,null,JSON.stringify(results.summary,null,"\t"),2000,handleRequest);return ;}element.innerHTML=""+status.index+" unit tests of "+status.total+" completed...";window.setTimeout(sendStatusMessage,500);}function actOnMessage(depr1,depr2,message){if(message.sender===workerId){checkTests(message.body);}}function isGearsAvailable(){return window.google&&google&&google.gears&&google.gears.factory.hasPermission;}if(isGearsAvailable()){worker=google.gears.factory.create("beta.workerpool");worker.onmessage=actOnMessage;workerId=worker.createWorkerFromUrl(scriptUrl+"?nocache="+new Date().getTime());worker.sendMessage({command:"clutch.test.run"},workerId);}else{element.innerHTML="Can't run tests because Gears is not installed, or permission has not been given";}};